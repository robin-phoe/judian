import{c as P,d as G,e as I,f as Y,g as Q,h as ee,j as oe,k as le,l as te,m as ae,n as ne,o as se,p as ue}from"./element-plus.32df0a3b.js";import"./axios.451cdb92.js";import{s as de,a as ie,g as W,b as re,c as ce,d as me,o as _e,p as pe}from"./api.ebb9604f.js";import"./qs.cb2714fe.js";import{_ as O}from"./index.1b638969.js";import{b as ve,a as v,l as b,m as D,W as l,Q as a,p as u,U as y,F as L,a5 as A,u as p,E as B,aw as T,ax as M,P as j,I as fe,V as U,R as H,X as q,$ as z,D as he,af as ye,T as ge}from"./@vue.a82e9935.js";import{_ as Ve}from"./lodash.02dd5408.js";import"./randomcolor.586e56a3.js";import{h as be}from"./moment.3fe379a8.js";import"./lodash-es.39464d94.js";import"./@vueuse.370d0333.js";import"./@popperjs.fd04dfd6.js";import"./@ctrl.5f67d428.js";import"./dayjs.38009a6e.js";import"./async-validator.73a10b83.js";import"./memoize-one.c87f6fc8.js";import"./escape-html.86960cf8.js";import"./normalize-wheel-es.e2b4fa49.js";import"./@floating-ui.cac404ee.js";import"./side-channel.0f31c79c.js";import"./get-intrinsic.0f3ed0a2.js";import"./has-symbols.6b764405.js";import"./function-bind.c99feded.js";import"./has.38a7880d.js";import"./call-bind.00b5229b.js";import"./object-inspect.d900f9c3.js";import"./vue-router.4f0e1aa5.js";import"./pinia.b147f849.js";import"./vue-demi.6e7a88e9.js";import"./default-passive-events.a10ec130.js";function K(f){f.target.value=f.target.value.match(/^\d*(\.?\d{0,2})/g)[0]||null}const ke=f=>(T("data-v-779400a0"),f=f(),M(),f),Ce={class:"room-dialog"},xe={class:"room-container"},$e=ke(()=>u("div",{class:"title"},[u("span",null,"\u623F\u95F4\u540D"),u("span",null,"\u5355\u4EF7(\u5143)"),u("span",null,"\u5957\u9910\u4EF7(\u5143)"),u("span",null,"\u5957\u9910\u65F6\u5E38"),u("span")],-1)),Ie={class:"content"},Re={class:"item add-item"},Ue={class:"dialog-footer"},De={__name:"RoomSet",props:{data:{type:Array}},emits:["reloadList"],setup(f,{expose:S,emit:w}){const h=f;ve(()=>h.data,d=>{});const n=v([]);let _=v(""),t=v(""),g=v(""),C=v("");function x(){if(_.value)if(t.value)if(g.value){if(!C.value){I.error("\u8BF7\u5148\u586B\u5165\u5957\u9910\u65F6\u957F");return}}else{I.error("\u8BF7\u5148\u586B\u5165\u5957\u9910\u4EF7");return}else{I.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}else{I.error("\u8BF7\u5148\u586B\u5165\u623F\u95F4\u540D");return}const d={id:"",name:_.value,price:t.value,base_price:g.value,base_hours:C.value};n.value.push(d),_.value="",t.value="",g.value="",C.value=""}function F(d){let m=n.value.findIndex(r=>r.name==d.name);n.value.splice(m,1)}let $=v(!1);function V(){$.value=!0,n.value=[],h.data.forEach(d=>{console.log(d),n.value.push({id:d.id,name:d.name,price:d.price,base_price:d.base_cost,base_hours:d.base_hours})})}function i(){$.value=!1,_.value="",t.value="",g.value="",C.value=""}async function s(){_.value&&t.value&&g.value&&C.value&&x();const d=await de(n.value);console.log(d),d.code==200?(I.success("\u7F16\u8F91\u6210\u529F"),w("reloadList"),i()):I.error(d.msg)}return S({show:V}),(d,m)=>{const r=P,c=Y,E=G;return b(),D("div",Ce,[l(E,{modelValue:p($),"onUpdate:modelValue":m[5]||(m[5]=o=>B($)?$.value=o:$=o),title:"\u623F\u95F4\u8BBE\u7F6E",width:"600",center:""},{footer:a(()=>[u("span",Ue,[l(c,{onClick:m[4]||(m[4]=o=>i())},{default:a(()=>[y("\u53D6\u6D88")]),_:1}),l(c,{type:"primary",onClick:s},{default:a(()=>[y(" \u786E\u8BA4 ")]),_:1})])]),default:a(()=>[u("div",xe,[$e,u("div",Ie,[(b(!0),D(L,null,A(n.value,o=>(b(),D("div",{class:"item del-items",key:o.id},[l(r,{placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D",modelValue:o.name,"onUpdate:modelValue":e=>o.name=e},null,8,["modelValue","onUpdate:modelValue"]),l(r,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",onKeyup:p(K),modelValue:o.price,"onUpdate:modelValue":e=>o.price=e},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),l(r,{placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u4EF7",onKeyup:p(K),modelValue:o.base_price,"onUpdate:modelValue":e=>o.base_price=e},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),l(r,{placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u65F6\u957F",onKeyup:p(K),modelValue:o.base_hours,"onUpdate:modelValue":e=>o.base_hours=e},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),l(c,{type:"danger",onClick:e=>F(o)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),u("div",Re,[l(r,{modelValue:p(_),"onUpdate:modelValue":m[0]||(m[0]=o=>B(_)?_.value=o:_=o),placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D"},null,8,["modelValue"]),l(r,{modelValue:p(t),"onUpdate:modelValue":m[1]||(m[1]=o=>B(t)?t.value=o:t=o),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue","onKeyup"]),l(r,{modelValue:p(g),"onUpdate:modelValue":m[2]||(m[2]=o=>B(g)?g.value=o:g=o),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u4EF7"},null,8,["modelValue","onKeyup"]),l(r,{modelValue:p(C),"onUpdate:modelValue":m[3]||(m[3]=o=>B(C)?C.value=o:C=o),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u65F6\u957F"},null,8,["modelValue","onKeyup"]),l(c,{type:"primary",onClick:x},{default:a(()=>[y("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])])}}},Ee=O(De,[["__scopeId","data-v-779400a0"]]);const Se=f=>(T("data-v-1a8d218c"),f=f(),M(),f),we={class:"room-container"},Fe=Se(()=>u("div",{class:"title"},[u("span",null,"\u5546\u54C1\u540D\u79F0"),u("span",null,"\u5355\u4EF7(\u5143)"),u("span")],-1)),Be={class:"content"},je={class:"item add-item"},Ke={class:"dialog-footer"},Le={__name:"GoodsSet",props:{data:{type:Array}},emits:["reloadList"],setup(f,{expose:S,emit:w}){async function h(){n.value=[];const i=await W();console.log(i),i.code==200&&i.data.forEach(s=>{n.value.push(s)})}const n=v([]);let _=v(""),t=v("");function g(){if(_.value){if(!t.value){I.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}}else{I.error("\u8BF7\u5148\u586B\u5165\u5546\u54C1\u540D\u79F0");return}const i={id:"",name:_.value,price:t.value};n.value.push(i),_.value="",t.value=""}function C(i){let s=n.value.findIndex(d=>d.name==i.name);n.value.splice(s,1)}let x=v(!1);function F(){x.value=!0,h()}function $(){x.value=!1}async function V(){_.value&&t&&g();const i=await ie(n.value);i.code==200?(I.success("\u7F16\u8F91\u6210\u529F"),w("reloadList"),$()):I.error(i.msg)}return S({show:F}),(i,s)=>{const d=P,m=Y,r=G;return b(),j(r,{modelValue:p(x),"onUpdate:modelValue":s[3]||(s[3]=c=>B(x)?x.value=c:x=c),title:"\u5546\u54C1\u8BBE\u7F6E",width:"600",center:""},{footer:a(()=>[u("span",Ke,[l(m,{onClick:s[2]||(s[2]=c=>$())},{default:a(()=>[y("\u53D6\u6D88")]),_:1}),l(m,{type:"primary",onClick:V},{default:a(()=>[y(" \u786E\u8BA4 ")]),_:1})])]),default:a(()=>[u("div",we,[Fe,u("div",Be,[(b(!0),D(L,null,A(n.value,c=>(b(),D("div",{class:"item del-items",key:c.name},[l(d,{placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",modelValue:c.name,"onUpdate:modelValue":E=>c.name=E},null,8,["modelValue","onUpdate:modelValue"]),l(d,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",modelValue:c.price,"onUpdate:modelValue":E=>c.price=E},null,8,["modelValue","onUpdate:modelValue"]),l(m,{type:"danger",onClick:E=>C(c)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),u("div",je,[l(d,{modelValue:p(_),"onUpdate:modelValue":s[0]||(s[0]=c=>B(_)?_.value=c:_=c),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"]),l(d,{modelValue:p(t),"onUpdate:modelValue":s[1]||(s[1]=c=>B(t)?t.value=c:t=c),modelModifiers:{number:!0},placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue"]),l(m,{type:"primary",onClick:g},{default:a(()=>[y("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])}}},Ae=O(Le,[["__scopeId","data-v-1a8d218c"]]);const X=f=>(T("data-v-69674ca9"),f=f(),M(),f),Ye={class:"order-container"},Ge={class:"yidian"},Oe=X(()=>u("div",{class:"desc"},"\u5DF2\u70B9",-1)),Te={class:"box"},Me={class:"goods-wrap"},Ne=X(()=>u("div",{class:"desc"},"\u5546\u54C1",-1)),Pe={class:"goods-box"},He={class:"name"},qe={class:"price"},ze={class:"choose-wrap"},Qe={class:"choose-item"},We={class:"handle-box"},Xe=fe({__name:"Order",emits:["reloadList"],setup(f,{expose:S,emit:w}){const h=v([]),n=v([]);async function _(){n.value=[];const o=await W();o.code==200&&o.data.forEach(e=>{n.value.push(e)})}const t=v("");let g;function C(o){t.value=o.name,g=h.value.findIndex(e=>e.order_content===o.name)}function x(o){console.log(o),t.value=o.name,g=h.value.findIndex(e=>e.order_content===o.name),$()}function F(o){console.log(o),Q.confirm("\u786E\u8BA4\u5220\u9664?","\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{h.value.splice(o,1),console.log(h.value),h.value=h.value}).catch(()=>{})}function $(){if(!t.value)return;let o={order_content:t.value,count:V.value};g===-1?h.value.push(o):h.value[g].count+=V.value,V.value=1,t.value=""}const V=v(1),i=o=>{console.log(o)};async function s(){console.log("click"),h.value.forEach(k=>{k!=null&&k.order_id||(k.order_id="")});let o={id:r.value,data:h.value};console.log(o);const e=await re(o);e.code==200?(I.success("\u7F16\u8F91\u6210\u529F"),w("reloadList"),E()):I.error(e.msg)}const d=v("");let m=v(!1),r=v("");function c(o){m.value=!0,r.value=o.id,d.value=o.name+"\u70B9\u5355",_(),h.value=Ve.cloneDeep(o.order_info)}function E(){m.value=!1}return S({show:c}),(o,e)=>{const k=Y,J=ee,Z=G;return b(),j(Z,{modelValue:p(m),"onUpdate:modelValue":e[1]||(e[1]=R=>B(m)?m.value=R:m=R),title:d.value,width:"900",center:""},{default:a(()=>[u("div",Ye,[u("div",Ge,[Oe,u("div",Te,[(b(!0),D(L,null,A(h.value,(R,N)=>(b(),D("div",{class:"item",key:R.order_id},[y(U(R.order_content)+" x "+U(R.count)+" ",1),l(k,{size:"small",link:"",type:"danger",onClick:mo=>F(N)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128))])]),u("div",Me,[Ne,u("div",Pe,[(b(!0),D(L,null,A(n.value,R=>(b(),j(k,{class:"item",onClick:N=>C(R),onDblclick:N=>x(R)},{default:a(()=>[u("span",He,U(R.name),1),u("span",qe,U(R.price)+"\u5143",1)]),_:2},1032,["onClick","onDblclick"]))),256))])]),u("div",ze,[u("div",Qe,U(t.value),1),u("div",We,[H(l(J,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=R=>V.value=R),min:1,max:999,onChange:i},null,8,["modelValue"]),[[q,t.value]]),H(l(k,{type:"primary",onClick:$},{default:a(()=>[y("\u786E\u5B9A")]),_:1},512),[[q,t.value]]),l(k,{type:"primary",onClick:s},{default:a(()=>[y("\u4FDD\u5B58")]),_:1})])])])]),_:1},8,["modelValue","title"])}}}),Je=O(Xe,[["__scopeId","data-v-69674ca9"]]),Ze={__name:"ChangeRoomset",emits:["reloadList"],setup(f,{expose:S,emit:w}){const h=v(""),n=z({id:"",ymd:be().format("YYYY-MM-DD"),hms:"",adjust_money:""}),_=z({hms:[{required:!0,message:"\u8BF7\u8F93\u5165\u65F6\u95F4",trigger:"blur"}],adjust_money:[{required:!0,message:"\u8BF7\u8F93\u5165\u8C03\u5DEE\u91D1\u989D",trigger:"blur"}]}),t=v(null),g=()=>{t.value.validate(async V=>{if(V){console.log("submit!",n.time);let i={id:n.id,start_time:n.ymd+" "+n.hms,adjust_money:n.adjust_money};const s=await ce(i);s.code==200?(I.success("\u7F16\u8F91\u6210\u529F"),w("reloadList"),C()):I.error(s.msg)}else return console.log("error submit!"),!1})},C=()=>{t.value.resetFields(),$()},x=v(!1);function F(V){h.value=V.name+"\u4FE1\u606F\u53D8\u66F4\u8BBE\u7F6E",n.id=V.id,n.adjust_money=V.adjust_money,V.start_time!=="--:--:--"&&(n.hms=V.start_time),x.value=!0}function $(){x.value=!1}return S({show:F}),(V,i)=>{const s=oe,d=le,m=te,r=P,c=Y,E=ae,o=G;return b(),j(o,{modelValue:x.value,"onUpdate:modelValue":i[5]||(i[5]=e=>x.value=e),title:h.value,width:"600",center:""},{default:a(()=>[l(E,{ref_key:"ruleFormRef",ref:t,model:p(n),"status-icon":"",rules:p(_),"label-width":"120px",class:"demo-ruleForm"},{default:a(()=>[l(d,{label:"\u65E5\u671F",prop:"ymd"},{default:a(()=>[l(s,{modelValue:p(n).ymd,"onUpdate:modelValue":i[0]||(i[0]=e=>p(n).ymd=e),type:"date",placeholder:"\u9009\u62E9\u65F6\u95F4",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u65F6\u95F4",prop:"hms"},{default:a(()=>[l(m,{"value-format":"HH:mm:ss",modelValue:p(n).hms,"onUpdate:modelValue":i[1]||(i[1]=e=>p(n).hms=e),placeholder:"\u5F00\u59CB\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u624B\u52A8\u8C03\u5DEE\u91D1\u989D",prop:"adjust_money"},{default:a(()=>[l(r,{onKeyup:p(K),modelValue:p(n).adjust_money,"onUpdate:modelValue":i[2]||(i[2]=e=>p(n).adjust_money=e)},null,8,["onKeyup","modelValue"])]),_:1}),l(d,null,{default:a(()=>[l(c,{type:"primary",onClick:i[3]||(i[3]=e=>g(t.value))},{default:a(()=>[y("\u786E\u8BA4")]),_:1}),l(c,{onClick:i[4]||(i[4]=e=>C(t.value))},{default:a(()=>[y("\u53D6\u6D88")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}};const eo=f=>(T("data-v-b3e124ca"),f=f(),M(),f),oo={class:"dashborad-container"},lo={class:"left-nav"},to=eo(()=>u("div",{class:"nav-item"}," \u5386\u53F2\u8BA2\u5355 ",-1)),ao={class:"content"},no=["onClick"],so=["onClick"],uo=["onClick"],io={class:"g-item"},ro=["onClick"],co={__name:"index",setup(f){function S(s){console.log("click"),Q.confirm(`\u786E\u8BA4${s.order_status=="ending"?"\u5F00\u59CB":"\u7ED3\u675F"}\u5F53\u524D\u8BA2\u5355\uFF1F`,"\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const d=await _e({id:s.id,action:s.order_status==="ending"?"open":"end"});t(),console.log(d)}).catch(()=>{})}async function w(s){console.log(s.pause_status);const d=await pe({id:s.id,action:s.pause_status==="running"?"pause":"run"});d.code==200?(I.success("\u64CD\u4F5C\u6210\u529F"),t()):I.success(d.msg)}const h=v(null);function n(s){h.value.show(s)}const _=v([]);async function t(){const s=await me();console.log(s),s.code==200&&(_.value=s.data)}he(()=>{clearInterval(g)});var g=setInterval(()=>{t()},5e3);t();let C=v(null);function x(){console.log("123"),C.value.show()}let F=v(null);function $(){F.value.show()}let V=v(null);function i(s){V.value.show(s)}return(s,d)=>{const m=ye("router-link"),r=ne,c=Y,E=se,o=ue;return b(),D(L,null,[u("div",oo,[u("div",lo,[u("div",{class:"nav-item",onClick:x}," \u623F\u95F4\u8BBE\u7F6E "),u("div",{class:"nav-item",onClick:$}," \u5546\u54C1\u8BBE\u7F6E "),l(m,{to:"/history"},{default:a(()=>[to]),_:1})]),u("div",ao,[l(E,{data:p(_),border:"",style:{width:"100%"}},{default:a(()=>[l(r,{align:"center",prop:"name",label:"\u623F\u95F4\u540D",width:"150"}),l(r,{align:"center",prop:"price",label:"\u5355\u4EF7",width:"120"},{default:a(({row:e})=>[y(U(e.price)+" \u5143 ",1)]),_:1}),l(r,{align:"center",prop:"start_time",label:"\u5F00\u59CB\u65F6\u95F4"},{default:a(({row:e})=>[u("div",{class:"sd",onClick:k=>n(e)},U(e.start_time),9,no)]),_:1}),l(r,{align:"center",prop:"end_time",label:"\u7ED3\u675F\u65F6\u95F4"}),l(r,{align:"center",prop:"total_time",label:"\u5F53\u524D\u65F6\u957F"}),l(r,{align:"center",prop:"pause_time",label:"\u6682\u505C\u65F6\u957F"}),l(r,{align:"center",prop:"base_cost",label:"\u5957\u9910\u8D39\u7528"},{default:a(({row:e})=>[y(U(e.base_cost)+" \u5143 ",1)]),_:1}),l(r,{align:"center",prop:"add_time_cost",label:"\u52A0\u65F6\u8D39\u7528"},{default:a(({row:e})=>[y(U(e.add_time_cost)+" \u5143 ",1)]),_:1}),l(r,{align:"center",prop:"adjust_money",label:"\u624B\u52A8\u8C03\u5DEE"},{default:a(({row:e})=>[u("div",{class:"sd",onClick:k=>n(e)},U(e.adjust_money)+" \u5143",9,so)]),_:1}),l(r,{align:"center",prop:"cost",label:"\u603B\u8D39\u7528"},{default:a(({row:e})=>[y(U(e.cost)+" \u5143 ",1)]),_:1}),l(r,{align:"center",prop:"order_info",label:"\u8BA2\u5355","min-width":"200"},{default:a(({row:e})=>[e.order_info.length>0?(b(),D("div",{key:0,class:"order-box",onClick:k=>i(e)},[ge(' {{ row.order_info.join(",") }} '),(b(!0),D(L,null,A(e.order_info,k=>(b(),D("span",io,U(k.order_content)+" x "+U(k.count),1))),256))],8,uo)):(b(),D("a",{key:1,class:"no-data-link c-p",onClick:k=>i(e)},"\u53BB\u6DFB\u52A0\u5546\u54C1",8,ro))]),_:1}),l(r,{align:"center",fixed:"right",prop:"zip",label:"\u6682\u505C/\u6062\u590D",width:"120"},{default:a(({row:e})=>[e.pause_status==="running"?(b(),j(c,{key:0,type:"primary",onClick:k=>w(e)},{default:a(()=>[y("\u6682\u505C")]),_:2},1032,["onClick"])):(b(),j(c,{key:1,type:"danger",onClick:k=>w(e)},{default:a(()=>[y("\u6062\u590D")]),_:2},1032,["onClick"]))]),_:1}),l(r,{align:"center",fixed:"right",label:"\u5F00\u5355/\u7ED3\u5355",width:"120"},{default:a(({row:e})=>[e.order_status==="ending"?(b(),j(c,{key:0,type:"primary",onClick:k=>S(e)},{default:a(()=>[y("\u5F00\u5355")]),_:2},1032,["onClick"])):(b(),j(c,{key:1,type:"danger",onClick:k=>S(e)},{default:a(()=>[y("\u7ED3\u5355")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),l(o,{class:"footer-box"},{default:a(()=>[y(" @\u6210\u90FD\u69F2\u53F6\u79D1\u6280\u6709\u9650\u516C\u53F8 ")]),_:1})])]),l(Ee,{data:p(_),onReloadList:t,ref_key:"RoomSetRef",ref:C},null,8,["data"]),l(Ae,{onReloadList:t,ref_key:"GoodsSetRef",ref:F},null,512),l(Je,{ref_key:"OrderRef",ref:V,onReloadList:t},null,512),l(Ze,{ref_key:"ChangeRoomsetRef",ref:h,onReloadList:t},null,512)],64)}}},Mo=O(co,[["__scopeId","data-v-b3e124ca"]]);export{Mo as default};
