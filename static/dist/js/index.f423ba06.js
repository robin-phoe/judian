import{c as Q,d as P,e as x,f as F,g as W,h as Z,j as ee,k as oe}from"./element-plus.a660ad05.js";import"./axios.451cdb92.js";import{s as te,a as le,g as X,b as ae,c as ne,o as se,p as ie}from"./api.52d2d845.js";import"./qs.cb2714fe.js";import{_ as T}from"./index.21d1c3b5.js";import{b as de,a as h,l as f,m as b,W as o,Q as n,p as t,U as g,F as L,a5 as O,u as $,E as G,aw as N,ax as j,P as A,I as ce,V as S,R as K,X as M,D as ue,af as re,T as pe}from"./@vue.a82e9935.js";import{_ as _e}from"./lodash.02dd5408.js";import"./randomcolor.586e56a3.js";import"./lodash-es.39464d94.js";import"./@vueuse.370d0333.js";import"./@popperjs.fd04dfd6.js";import"./@ctrl.5f67d428.js";import"./dayjs.38009a6e.js";import"./async-validator.73a10b83.js";import"./memoize-one.c87f6fc8.js";import"./escape-html.86960cf8.js";import"./normalize-wheel-es.e2b4fa49.js";import"./@floating-ui.cac404ee.js";import"./side-channel.0f31c79c.js";import"./get-intrinsic.0f3ed0a2.js";import"./has-symbols.6b764405.js";import"./function-bind.c99feded.js";import"./has.38a7880d.js";import"./call-bind.00b5229b.js";import"./object-inspect.d900f9c3.js";import"./vue-router.4f0e1aa5.js";import"./pinia.b147f849.js";import"./vue-demi.6e7a88e9.js";import"./default-passive-events.a10ec130.js";function H(u){u.target.value=u.target.value.match(/^\d*(\.?\d{0,2})/g)[0]||null}const me=u=>(N("data-v-199f46ee"),u=u(),j(),u),ve={class:"room-dialog"},fe={class:"room-container"},he=me(()=>t("div",{class:"title"},[t("span",null,"\u623F\u95F4\u540D"),t("span",null,"\u5355\u4EF7(\u5143)"),t("span")],-1)),ge={class:"content"},ye={class:"item add-item"},ke={class:"dialog-footer"},Ve={__name:"RoomSet",props:{data:{type:Array}},emits:["reloadList"],setup(u,{expose:D,emit:R}){const p=u;de(()=>p.data,l=>{});const s=h([]);let _=h(""),a=h("");function C(){if(_.value){if(!a.value){x.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}}else{x.error("\u8BF7\u5148\u586B\u5165\u623F\u95F4\u540D");return}const l={id:"",name:_.value,price:a.value};s.value.push(l),_.value="",a.value=""}function E(l){let i=s.value.findIndex(d=>d.name==l.name);s.value.splice(i,1)}let y=h(!1);function U(){y.value=!0,s.value=[],p.data.forEach(l=>{s.value.push({id:l.id,name:l.name,price:l.price})})}function I(){y.value=!1}async function r(){_.value&&a&&C();const l=await te(s.value);console.log(l),l.code==200?(x.success("\u7F16\u8F91\u6210\u529F"),R("reloadList"),I()):x.error(l.msg)}return D({show:U}),(l,i)=>{const d=Q,m=F,B=P;return f(),b("div",ve,[o(B,{modelValue:$(y),"onUpdate:modelValue":i[3]||(i[3]=e=>G(y)?y.value=e:y=e),title:"\u623F\u95F4\u8BBE\u7F6E",width:"600",center:""},{footer:n(()=>[t("span",ke,[o(m,{onClick:i[2]||(i[2]=e=>I())},{default:n(()=>[g("\u53D6\u6D88")]),_:1}),o(m,{type:"primary",onClick:r},{default:n(()=>[g(" \u786E\u8BA4 ")]),_:1})])]),default:n(()=>[t("div",fe,[he,t("div",ge,[(f(!0),b(L,null,O(s.value,e=>(f(),b("div",{class:"item del-items",key:e.id},[o(d,{placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D",modelValue:e.name,"onUpdate:modelValue":v=>e.name=v},null,8,["modelValue","onUpdate:modelValue"]),o(d,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",onKeyup:$(H),modelValue:e.price,"onUpdate:modelValue":v=>e.price=v},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),o(m,{type:"danger",onClick:v=>E(e)},{default:n(()=>[g("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),t("div",ye,[o(d,{modelValue:$(_),"onUpdate:modelValue":i[0]||(i[0]=e=>G(_)?_.value=e:_=e),placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D"},null,8,["modelValue"]),o(d,{modelValue:$(a),"onUpdate:modelValue":i[1]||(i[1]=e=>G(a)?a.value=e:a=e),onKeyup:$(H),placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue","onKeyup"]),o(m,{type:"primary",onClick:C},{default:n(()=>[g("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])])}}},be=T(Ve,[["__scopeId","data-v-199f46ee"]]);const Ce=u=>(N("data-v-a968bc60"),u=u(),j(),u),xe={class:"room-container"},Ie=Ce(()=>t("div",{class:"title"},[t("span",null,"\u5546\u54C1\u540D\u79F0"),t("span",null,"\u5355\u4EF7(\u5143)"),t("span")],-1)),$e={class:"content"},we={class:"item add-item"},Se={class:"dialog-footer"},De={__name:"GoodsSet",props:{data:{type:Array}},emits:["reloadList"],setup(u,{expose:D,emit:R}){async function p(){s.value=[];const l=await X();console.log(l),l.code==200&&l.data.forEach(i=>{s.value.push(i)})}const s=h([]);let _=h(""),a=h("");function C(){if(_.value){if(!a.value){x.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}}else{x.error("\u8BF7\u5148\u586B\u5165\u5546\u54C1\u540D\u79F0");return}const l={id:"",name:_.value,price:a.value};s.value.push(l),_.value="",a.value=""}function E(l){let i=s.value.findIndex(d=>d.name==l.name);s.value.splice(i,1)}let y=h(!1);function U(){y.value=!0,p()}function I(){y.value=!1}async function r(){_.value&&a&&C();const l=await le(s.value);l.code==200?(x.success("\u7F16\u8F91\u6210\u529F"),R("reloadList"),I()):x.error(l.msg)}return D({show:U}),(l,i)=>{const d=Q,m=F,B=P;return f(),A(B,{modelValue:$(y),"onUpdate:modelValue":i[3]||(i[3]=e=>G(y)?y.value=e:y=e),title:"\u5546\u54C1\u8BBE\u7F6E",width:"600",center:""},{footer:n(()=>[t("span",Se,[o(m,{onClick:i[2]||(i[2]=e=>I())},{default:n(()=>[g("\u53D6\u6D88")]),_:1}),o(m,{type:"primary",onClick:r},{default:n(()=>[g(" \u786E\u8BA4 ")]),_:1})])]),default:n(()=>[t("div",xe,[Ie,t("div",$e,[(f(!0),b(L,null,O(s.value,e=>(f(),b("div",{class:"item del-items",key:e.name},[o(d,{placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",modelValue:e.name,"onUpdate:modelValue":v=>e.name=v},null,8,["modelValue","onUpdate:modelValue"]),o(d,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",modelValue:e.price,"onUpdate:modelValue":v=>e.price=v},null,8,["modelValue","onUpdate:modelValue"]),o(m,{type:"danger",onClick:v=>E(e)},{default:n(()=>[g("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),t("div",we,[o(d,{modelValue:$(_),"onUpdate:modelValue":i[0]||(i[0]=e=>G(_)?_.value=e:_=e),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"]),o(d,{modelValue:$(a),"onUpdate:modelValue":i[1]||(i[1]=e=>G(a)?a.value=e:a=e),modelModifiers:{number:!0},placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue"]),o(m,{type:"primary",onClick:C},{default:n(()=>[g("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])}}},Re=T(De,[["__scopeId","data-v-a968bc60"]]);const q=u=>(N("data-v-5e0ecc86"),u=u(),j(),u),Ee={class:"order-container"},Ue={class:"yidian"},Be=q(()=>t("div",{class:"desc"},"\u5DF2\u70B9",-1)),Ae={class:"box"},Ge={class:"goods-wrap"},Le=q(()=>t("div",{class:"desc"},"\u5546\u54C1",-1)),Oe={class:"goods-box"},Fe={class:"name"},Te={class:"price"},Ne={class:"choose-wrap"},je={class:"choose-item"},ze={class:"handle-box"},Pe=ce({__name:"Order",emits:["reloadList"],setup(u,{expose:D,emit:R}){const p=h([]),s=h([]);async function _(){s.value=[];const c=await X();c.code==200&&c.data.forEach(k=>{s.value.push(k)})}const a=h("");let C;function E(c){a.value=c.name,C=p.value.findIndex(k=>k.order_content===c.name)}function y(c){console.log(c),a.value=c.name,C=p.value.findIndex(k=>k.order_content===c.name),I()}function U(c){console.log(c),W.confirm("\u786E\u8BA4\u5220\u9664?","\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{p.value.splice(c,1),console.log(p.value),p.value=p.value}).catch(()=>{})}function I(){if(!a.value)return;let c={order_content:a.value,count:r.value};C===-1?p.value.push(c):p.value[C]=c,r.value=1,a.value=""}const r=h(1),l=c=>{console.log(c)};async function i(){console.log("click"),p.value.forEach(w=>{w!=null&&w.order_id||(w.order_id="")});let c={id:B.value,data:p.value};console.log(c);const k=await ae(c);k.code==200?(x.success("\u7F16\u8F91\u6210\u529F"),R("reloadList"),v()):x.error(k.msg)}const d=h("");let m=h(!1),B=h("");function e(c){m.value=!0,B.value=c.id,d.value=c.name+"\u70B9\u5355",_(),p.value=_e.cloneDeep(c.order_info)}function v(){m.value=!1}return D({show:e}),(c,k)=>{const w=F,J=Z,Y=P;return f(),A(Y,{modelValue:$(m),"onUpdate:modelValue":k[1]||(k[1]=V=>G(m)?m.value=V:m=V),title:d.value,width:"900",center:""},{default:n(()=>[t("div",Ee,[t("div",Ue,[Be,t("div",Ae,[(f(!0),b(L,null,O(p.value,(V,z)=>(f(),b("div",{class:"item",key:V.order_id},[g(S(V.order_content)+" x "+S(V.count)+" ",1),o(w,{size:"small",link:"",type:"danger",onClick:eo=>U(z)},{default:n(()=>[g("\u5220\u9664")]),_:2},1032,["onClick"])]))),128))])]),t("div",Ge,[Le,t("div",Oe,[(f(!0),b(L,null,O(s.value,V=>(f(),A(w,{class:"item",onClick:z=>E(V),onDblclick:z=>y(V)},{default:n(()=>[t("span",Fe,S(V.name),1),t("span",Te,S(V.price)+"\u5143",1)]),_:2},1032,["onClick","onDblclick"]))),256))])]),t("div",Ne,[t("div",je,S(a.value),1),t("div",ze,[K(o(J,{modelValue:r.value,"onUpdate:modelValue":k[0]||(k[0]=V=>r.value=V),min:1,max:999,onChange:l},null,8,["modelValue"]),[[M,a.value]]),K(o(w,{type:"primary",onClick:I},{default:n(()=>[g("\u786E\u5B9A")]),_:1},512),[[M,a.value]]),o(w,{type:"primary",onClick:i},{default:n(()=>[g("\u4FDD\u5B58")]),_:1})])])])]),_:1},8,["modelValue","title"])}}}),Ke=T(Pe,[["__scopeId","data-v-5e0ecc86"]]);const Me=u=>(N("data-v-7a6f2bbf"),u=u(),j(),u),He={class:"dashborad-container"},Qe={class:"left-nav"},We=Me(()=>t("div",{class:"nav-item"}," \u5386\u53F2\u8BA2\u5355 ",-1)),Xe={class:"content"},qe=["onClick"],Je={class:"g-item"},Ye=["onClick"],Ze={__name:"index",setup(u){function D(r){console.log("click"),W.confirm(`\u786E\u8BA4${r.order_status=="ending"?"\u5F00\u59CB":"\u7ED3\u675F"}\u5F53\u524D\u8BA2\u5355\uFF1F`,"\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const l=await se({id:r.id,action:r.order_status==="ending"?"open":"end"});s(),console.log(l)}).catch(()=>{})}async function R(r){console.log(r.pause_status);const l=await ie({id:r.id,action:r.pause_status==="running"?"pause":"run"});l.code==200?(x.success("\u64CD\u4F5C\u6210\u529F"),s()):x.success(l.msg)}const p=h([]);async function s(){const r=await ne();console.log(r),r.code==200&&(p.value=r.data)}ue(()=>{clearInterval(_)});var _=setInterval(()=>{s()},5e3);s();let a=h(null);function C(){console.log("123"),a.value.show()}let E=h(null);function y(){E.value.show()}let U=h(null);function I(r){U.value.show(r)}return(r,l)=>{const i=re("router-link"),d=ee,m=F,B=oe;return f(),b(L,null,[t("div",He,[t("div",Qe,[t("div",{class:"nav-item",onClick:C}," \u623F\u95F4\u8BBE\u7F6E "),t("div",{class:"nav-item",onClick:y}," \u5546\u54C1\u8BBE\u7F6E "),o(i,{to:"/history"},{default:n(()=>[We]),_:1})]),t("div",Xe,[o(B,{data:$(p),border:"",style:{width:"100%"}},{default:n(()=>[o(d,{align:"center",prop:"name",label:"\u623F\u95F4\u540D",width:"150"}),o(d,{align:"center",prop:"price",label:"\u5355\u4EF7",width:"120"},{default:n(({row:e})=>[g(S(e.price)+" \u5143 ",1)]),_:1}),o(d,{align:"center",prop:"start_time",label:"\u5F00\u59CB\u65F6\u95F4"}),o(d,{align:"center",prop:"end_time",label:"\u7ED3\u675F\u65F6\u95F4"}),o(d,{align:"center",prop:"total_time",label:"\u5F53\u524D\u65F6\u957F"}),o(d,{align:"center",prop:"pause_time",label:"\u6682\u505C\u65F6\u957F"}),o(d,{align:"center",prop:"cost",label:"\u603B\u8D39\u7528"},{default:n(({row:e})=>[g(S(e.cost)+" \u5143 ",1)]),_:1}),o(d,{align:"center",prop:"order_info",label:"\u8BA2\u5355","min-width":"200"},{default:n(({row:e})=>[e.order_info.length>0?(f(),b("div",{key:0,class:"order-box",onClick:v=>I(e)},[pe(' {{ row.order_info.join(",") }} '),(f(!0),b(L,null,O(e.order_info,v=>(f(),b("span",Je,S(v.order_content)+" x "+S(v.count),1))),256))],8,qe)):(f(),b("a",{key:1,class:"no-data-link c-p",onClick:v=>I(e)},"\u53BB\u6DFB\u52A0\u5546\u54C1",8,Ye))]),_:1}),o(d,{align:"center",fixed:"right",prop:"zip",label:"\u6682\u505C/\u6062\u590D",width:"120"},{default:n(({row:e})=>[e.pause_status==="running"?(f(),A(m,{key:0,size:"small",type:"primary",onClick:v=>R(e)},{default:n(()=>[g("\u6682\u505C")]),_:2},1032,["onClick"])):(f(),A(m,{key:1,type:"danger",size:"small",onClick:v=>R(e)},{default:n(()=>[g("\u6062\u590D")]),_:2},1032,["onClick"]))]),_:1}),o(d,{align:"center",fixed:"right",label:"\u5F00\u5355/\u7ED3\u5355",width:"120"},{default:n(({row:e})=>[e.order_status==="ending"?(f(),A(m,{key:0,type:"primary",size:"small",onClick:v=>D(e)},{default:n(()=>[g("\u5F00\u5355")]),_:2},1032,["onClick"])):(f(),A(m,{key:1,type:"danger",size:"small",onClick:v=>D(e)},{default:n(()=>[g("\u7ED3\u5355")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])])]),o(be,{data:$(p),onReloadList:s,ref_key:"RoomSetRef",ref:a},null,8,["data"]),o(Re,{onReloadList:s,ref_key:"GoodsSetRef",ref:E},null,512),o(Ke,{ref_key:"OrderRef",ref:U,onReloadList:s},null,512)],64)}}},Eo=T(Ze,[["__scopeId","data-v-7a6f2bbf"]]);export{Eo as default};
