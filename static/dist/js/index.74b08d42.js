import{c as P,d as G,e as $,f as Y,g as Q,h as ee,j as oe,k as le,l as te,m as ae,n as ne,o as se}from"./element-plus.3c007d8c.js";import"./axios.451cdb92.js";import{s as ue,a as de,g as W,b as ie,c as re,d as ce,o as me,p as _e}from"./api.69717a60.js";import"./qs.cb2714fe.js";import{_ as O}from"./index.728dfb7f.js";import{b as pe,a as v,l as b,m as U,W as o,Q as a,p as u,U as y,F as L,a5 as A,u as p,E as F,aw as T,ax as M,P as j,I as ve,V as R,R as H,X as q,$ as z,D as fe,af as he,T as ye}from"./@vue.a82e9935.js";import{_ as ge}from"./lodash.02dd5408.js";import"./randomcolor.586e56a3.js";import{h as Ve}from"./moment.3fe379a8.js";import"./lodash-es.39464d94.js";import"./@vueuse.370d0333.js";import"./@popperjs.fd04dfd6.js";import"./@ctrl.5f67d428.js";import"./dayjs.38009a6e.js";import"./async-validator.73a10b83.js";import"./memoize-one.c87f6fc8.js";import"./escape-html.86960cf8.js";import"./normalize-wheel-es.e2b4fa49.js";import"./@floating-ui.cac404ee.js";import"./side-channel.0f31c79c.js";import"./get-intrinsic.0f3ed0a2.js";import"./has-symbols.6b764405.js";import"./function-bind.c99feded.js";import"./has.38a7880d.js";import"./call-bind.00b5229b.js";import"./object-inspect.d900f9c3.js";import"./vue-router.4f0e1aa5.js";import"./pinia.b147f849.js";import"./vue-demi.6e7a88e9.js";import"./default-passive-events.a10ec130.js";function K(f){f.target.value=f.target.value.match(/^\d*(\.?\d{0,2})/g)[0]||null}const be=f=>(T("data-v-c1a10bd8"),f=f(),M(),f),ke={class:"room-dialog"},Ce={class:"room-container"},xe=be(()=>u("div",{class:"title"},[u("span",null,"\u623F\u95F4\u540D"),u("span",null,"\u5355\u4EF7(\u5143)"),u("span",null,"\u5957\u9910\u4EF7(\u5143)"),u("span",null,"\u5957\u9910\u65F6\u5E38"),u("span")],-1)),$e={class:"content"},Ie={class:"item add-item"},Re={class:"dialog-footer"},Ue={__name:"RoomSet",props:{data:{type:Array}},emits:["reloadList"],setup(f,{expose:E,emit:S}){const h=f;pe(()=>h.data,d=>{});const n=v([]);let _=v(""),t=v(""),g=v(""),k=v("");function C(){if(_.value)if(t.value)if(g.value){if(!k.value){$.error("\u8BF7\u5148\u586B\u5165\u5957\u9910\u65F6\u957F");return}}else{$.error("\u8BF7\u5148\u586B\u5165\u5957\u9910\u4EF7");return}else{$.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}else{$.error("\u8BF7\u5148\u586B\u5165\u623F\u95F4\u540D");return}const d={id:"",name:_.value,price:t.value,base_price:g.value,base_hours:k.value};n.value.push(d),_.value="",t.value="",g.value="",k.value=""}function w(d){let m=n.value.findIndex(r=>r.name==d.name);n.value.splice(m,1)}let x=v(!1);function V(){x.value=!0,n.value=[],h.data.forEach(d=>{console.log(d),n.value.push({id:d.id,name:d.name,price:d.price,base_price:d.base_cost,base_hours:d.base_hours})})}function i(){x.value=!1,_.value="",t.value="",g.value="",k.value=""}async function s(){_.value&&t.value&&g.value&&k.value&&C();const d=await ue(n.value);console.log(d),d.code==200?($.success("\u7F16\u8F91\u6210\u529F"),S("reloadList"),i()):$.error(d.msg)}return E({show:V}),(d,m)=>{const r=P,c=Y,D=G;return b(),U("div",ke,[o(D,{modelValue:p(x),"onUpdate:modelValue":m[5]||(m[5]=e=>F(x)?x.value=e:x=e),title:"\u623F\u95F4\u8BBE\u7F6E",width:"600",center:""},{footer:a(()=>[u("span",Re,[o(c,{onClick:m[4]||(m[4]=e=>i())},{default:a(()=>[y("\u53D6\u6D88")]),_:1}),o(c,{type:"primary",onClick:s},{default:a(()=>[y(" \u786E\u8BA4 ")]),_:1})])]),default:a(()=>[u("div",Ce,[xe,u("div",$e,[(b(!0),U(L,null,A(n.value,e=>(b(),U("div",{class:"item del-items",key:e.id},[o(r,{placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D",modelValue:e.name,"onUpdate:modelValue":l=>e.name=l},null,8,["modelValue","onUpdate:modelValue"]),o(r,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",onKeyup:p(K),modelValue:e.price,"onUpdate:modelValue":l=>e.price=l},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),o(r,{placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u4EF7",onKeyup:p(K),modelValue:e.base_price,"onUpdate:modelValue":l=>e.base_price=l},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),o(r,{placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u65F6\u957F",onKeyup:p(K),modelValue:e.base_hours,"onUpdate:modelValue":l=>e.base_hours=l},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),o(c,{type:"danger",onClick:l=>w(e)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),u("div",Ie,[o(r,{modelValue:p(_),"onUpdate:modelValue":m[0]||(m[0]=e=>F(_)?_.value=e:_=e),placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D"},null,8,["modelValue"]),o(r,{modelValue:p(t),"onUpdate:modelValue":m[1]||(m[1]=e=>F(t)?t.value=e:t=e),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue","onKeyup"]),o(r,{modelValue:p(g),"onUpdate:modelValue":m[2]||(m[2]=e=>F(g)?g.value=e:g=e),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u4EF7"},null,8,["modelValue","onKeyup"]),o(r,{modelValue:p(k),"onUpdate:modelValue":m[3]||(m[3]=e=>F(k)?k.value=e:k=e),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u65F6\u957F"},null,8,["modelValue","onKeyup"]),o(c,{type:"primary",onClick:C},{default:a(()=>[y("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])])}}},De=O(Ue,[["__scopeId","data-v-c1a10bd8"]]);const Ee=f=>(T("data-v-a968bc60"),f=f(),M(),f),Se={class:"room-container"},we=Ee(()=>u("div",{class:"title"},[u("span",null,"\u5546\u54C1\u540D\u79F0"),u("span",null,"\u5355\u4EF7(\u5143)"),u("span")],-1)),Be={class:"content"},Fe={class:"item add-item"},je={class:"dialog-footer"},Ke={__name:"GoodsSet",props:{data:{type:Array}},emits:["reloadList"],setup(f,{expose:E,emit:S}){async function h(){n.value=[];const i=await W();console.log(i),i.code==200&&i.data.forEach(s=>{n.value.push(s)})}const n=v([]);let _=v(""),t=v("");function g(){if(_.value){if(!t.value){$.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}}else{$.error("\u8BF7\u5148\u586B\u5165\u5546\u54C1\u540D\u79F0");return}const i={id:"",name:_.value,price:t.value};n.value.push(i),_.value="",t.value=""}function k(i){let s=n.value.findIndex(d=>d.name==i.name);n.value.splice(s,1)}let C=v(!1);function w(){C.value=!0,h()}function x(){C.value=!1}async function V(){_.value&&t&&g();const i=await de(n.value);i.code==200?($.success("\u7F16\u8F91\u6210\u529F"),S("reloadList"),x()):$.error(i.msg)}return E({show:w}),(i,s)=>{const d=P,m=Y,r=G;return b(),j(r,{modelValue:p(C),"onUpdate:modelValue":s[3]||(s[3]=c=>F(C)?C.value=c:C=c),title:"\u5546\u54C1\u8BBE\u7F6E",width:"600",center:""},{footer:a(()=>[u("span",je,[o(m,{onClick:s[2]||(s[2]=c=>x())},{default:a(()=>[y("\u53D6\u6D88")]),_:1}),o(m,{type:"primary",onClick:V},{default:a(()=>[y(" \u786E\u8BA4 ")]),_:1})])]),default:a(()=>[u("div",Se,[we,u("div",Be,[(b(!0),U(L,null,A(n.value,c=>(b(),U("div",{class:"item del-items",key:c.name},[o(d,{placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",modelValue:c.name,"onUpdate:modelValue":D=>c.name=D},null,8,["modelValue","onUpdate:modelValue"]),o(d,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",modelValue:c.price,"onUpdate:modelValue":D=>c.price=D},null,8,["modelValue","onUpdate:modelValue"]),o(m,{type:"danger",onClick:D=>k(c)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),u("div",Fe,[o(d,{modelValue:p(_),"onUpdate:modelValue":s[0]||(s[0]=c=>F(_)?_.value=c:_=c),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"]),o(d,{modelValue:p(t),"onUpdate:modelValue":s[1]||(s[1]=c=>F(t)?t.value=c:t=c),modelModifiers:{number:!0},placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue"]),o(m,{type:"primary",onClick:g},{default:a(()=>[y("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])}}},Le=O(Ke,[["__scopeId","data-v-a968bc60"]]);const X=f=>(T("data-v-4cf72579"),f=f(),M(),f),Ae={class:"order-container"},Ye={class:"yidian"},Ge=X(()=>u("div",{class:"desc"},"\u5DF2\u70B9",-1)),Oe={class:"box"},Te={class:"goods-wrap"},Me=X(()=>u("div",{class:"desc"},"\u5546\u54C1",-1)),Ne={class:"goods-box"},Pe={class:"name"},He={class:"price"},qe={class:"choose-wrap"},ze={class:"choose-item"},Qe={class:"handle-box"},We=ve({__name:"Order",emits:["reloadList"],setup(f,{expose:E,emit:S}){const h=v([]),n=v([]);async function _(){n.value=[];const e=await W();e.code==200&&e.data.forEach(l=>{n.value.push(l)})}const t=v("");let g;function k(e){t.value=e.name,g=h.value.findIndex(l=>l.order_content===e.name)}function C(e){console.log(e),t.value=e.name,g=h.value.findIndex(l=>l.order_content===e.name),x()}function w(e){console.log(e),Q.confirm("\u786E\u8BA4\u5220\u9664?","\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{h.value.splice(e,1),console.log(h.value),h.value=h.value}).catch(()=>{})}function x(){if(!t.value)return;let e={order_content:t.value,count:V.value};g===-1?h.value.push(e):h.value[g].count+=V.value,V.value=1,t.value=""}const V=v(1),i=e=>{console.log(e)};async function s(){console.log("click"),h.value.forEach(B=>{B!=null&&B.order_id||(B.order_id="")});let e={id:r.value,data:h.value};console.log(e);const l=await ie(e);l.code==200?($.success("\u7F16\u8F91\u6210\u529F"),S("reloadList"),D()):$.error(l.msg)}const d=v("");let m=v(!1),r=v("");function c(e){m.value=!0,r.value=e.id,d.value=e.name+"\u70B9\u5355",_(),h.value=ge.cloneDeep(e.order_info)}function D(){m.value=!1}return E({show:c}),(e,l)=>{const B=Y,J=ee,Z=G;return b(),j(Z,{modelValue:p(m),"onUpdate:modelValue":l[1]||(l[1]=I=>F(m)?m.value=I:m=I),title:d.value,width:"900",center:""},{default:a(()=>[u("div",Ae,[u("div",Ye,[Ge,u("div",Oe,[(b(!0),U(L,null,A(h.value,(I,N)=>(b(),U("div",{class:"item",key:I.order_id},[y(R(I.order_content)+" x "+R(I.count)+" ",1),o(B,{size:"small",link:"",type:"danger",onClick:co=>w(N)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128))])]),u("div",Te,[Me,u("div",Ne,[(b(!0),U(L,null,A(n.value,I=>(b(),j(B,{class:"item",onClick:N=>k(I),onDblclick:N=>C(I)},{default:a(()=>[u("span",Pe,R(I.name),1),u("span",He,R(I.price)+"\u5143",1)]),_:2},1032,["onClick","onDblclick"]))),256))])]),u("div",qe,[u("div",ze,R(t.value),1),u("div",Qe,[H(o(J,{modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=I=>V.value=I),min:1,max:999,onChange:i},null,8,["modelValue"]),[[q,t.value]]),H(o(B,{type:"primary",onClick:x},{default:a(()=>[y("\u786E\u5B9A")]),_:1},512),[[q,t.value]]),o(B,{type:"primary",onClick:s},{default:a(()=>[y("\u4FDD\u5B58")]),_:1})])])])]),_:1},8,["modelValue","title"])}}}),Xe=O(We,[["__scopeId","data-v-4cf72579"]]),Je={__name:"ChangeRoomset",emits:["reloadList"],setup(f,{expose:E,emit:S}){const h=v(""),n=z({id:"",ymd:Ve().format("YYYY-MM-DD"),hms:"",adjust_money:""}),_=z({hms:[{required:!0,message:"\u8BF7\u8F93\u5165\u65F6\u95F4",trigger:"blur"}],adjust_money:[{required:!0,message:"\u8BF7\u8F93\u5165\u8C03\u5DEE\u91D1\u989D",trigger:"blur"}]}),t=v(null),g=()=>{t.value.validate(async V=>{if(V){console.log("submit!",n.time);let i={id:n.id,start_time:n.ymd+" "+n.hms,adjust_money:n.adjust_money};const s=await re(i);s.code==200?($.success("\u7F16\u8F91\u6210\u529F"),S("reloadList"),k()):$.error(s.msg)}else return console.log("error submit!"),!1})},k=()=>{t.value.resetFields(),x()},C=v(!1);function w(V){h.value=V.name+"\u4FE1\u606F\u53D8\u66F4\u8BBE\u7F6E",n.id=V.id,n.adjust_money=V.adjust_money,V.start_time!=="--:--:--"&&(n.hms=V.start_time),C.value=!0}function x(){C.value=!1}return E({show:w}),(V,i)=>{const s=oe,d=le,m=te,r=P,c=Y,D=ae,e=G;return b(),j(e,{modelValue:C.value,"onUpdate:modelValue":i[5]||(i[5]=l=>C.value=l),title:h.value,width:"600",center:""},{default:a(()=>[o(D,{ref_key:"ruleFormRef",ref:t,model:p(n),"status-icon":"",rules:p(_),"label-width":"120px",class:"demo-ruleForm"},{default:a(()=>[o(d,{label:"\u65E5\u671F",prop:"ymd"},{default:a(()=>[o(s,{modelValue:p(n).ymd,"onUpdate:modelValue":i[0]||(i[0]=l=>p(n).ymd=l),type:"date",placeholder:"\u9009\u62E9\u65F6\u95F4",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),o(d,{label:"\u65F6\u95F4",prop:"hms"},{default:a(()=>[o(m,{"value-format":"HH:mm:ss",modelValue:p(n).hms,"onUpdate:modelValue":i[1]||(i[1]=l=>p(n).hms=l),placeholder:"\u5F00\u59CB\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),o(d,{label:"\u624B\u52A8\u8C03\u5DEE\u91D1\u989D",prop:"adjust_money"},{default:a(()=>[o(r,{onKeyup:p(K),modelValue:p(n).adjust_money,"onUpdate:modelValue":i[2]||(i[2]=l=>p(n).adjust_money=l)},null,8,["onKeyup","modelValue"])]),_:1}),o(d,null,{default:a(()=>[o(c,{type:"primary",onClick:i[3]||(i[3]=l=>g(t.value))},{default:a(()=>[y("\u786E\u8BA4")]),_:1}),o(c,{onClick:i[4]||(i[4]=l=>k(t.value))},{default:a(()=>[y("\u53D6\u6D88")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}};const Ze=f=>(T("data-v-4ded734c"),f=f(),M(),f),eo={class:"dashborad-container"},oo={class:"left-nav"},lo=Ze(()=>u("div",{class:"nav-item"}," \u5386\u53F2\u8BA2\u5355 ",-1)),to={class:"content"},ao=["onClick"],no=["onClick"],so=["onClick"],uo={class:"g-item"},io=["onClick"],ro={__name:"index",setup(f){function E(s){console.log("click"),Q.confirm(`\u786E\u8BA4${s.order_status=="ending"?"\u5F00\u59CB":"\u7ED3\u675F"}\u5F53\u524D\u8BA2\u5355\uFF1F`,"\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const d=await me({id:s.id,action:s.order_status==="ending"?"open":"end"});t(),console.log(d)}).catch(()=>{})}async function S(s){console.log(s.pause_status);const d=await _e({id:s.id,action:s.pause_status==="running"?"pause":"run"});d.code==200?($.success("\u64CD\u4F5C\u6210\u529F"),t()):$.success(d.msg)}const h=v(null);function n(s){h.value.show(s)}const _=v([]);async function t(){const s=await ce();console.log(s),s.code==200&&(_.value=s.data)}fe(()=>{clearInterval(g)});var g=setInterval(()=>{t()},5e3);t();let k=v(null);function C(){console.log("123"),k.value.show()}let w=v(null);function x(){w.value.show()}let V=v(null);function i(s){V.value.show(s)}return(s,d)=>{const m=he("router-link"),r=ne,c=Y,D=se;return b(),U(L,null,[u("div",eo,[u("div",oo,[u("div",{class:"nav-item",onClick:C}," \u623F\u95F4\u8BBE\u7F6E "),u("div",{class:"nav-item",onClick:x}," \u5546\u54C1\u8BBE\u7F6E "),o(m,{to:"/history"},{default:a(()=>[lo]),_:1})]),u("div",to,[o(D,{data:p(_),border:"",style:{width:"100%"}},{default:a(()=>[o(r,{align:"center",prop:"name",label:"\u623F\u95F4\u540D",width:"150"}),o(r,{align:"center",prop:"price",label:"\u5355\u4EF7",width:"120"},{default:a(({row:e})=>[y(R(e.price)+" \u5143 ",1)]),_:1}),o(r,{align:"center",prop:"start_time",label:"\u5F00\u59CB\u65F6\u95F4"},{default:a(({row:e})=>[u("div",{class:"sd",onClick:l=>n(e)},R(e.start_time),9,ao)]),_:1}),o(r,{align:"center",prop:"end_time",label:"\u7ED3\u675F\u65F6\u95F4"}),o(r,{align:"center",prop:"total_time",label:"\u5F53\u524D\u65F6\u957F"}),o(r,{align:"center",prop:"pause_time",label:"\u6682\u505C\u65F6\u957F"}),o(r,{align:"center",prop:"base_cost",label:"\u5957\u9910\u8D39\u7528"},{default:a(({row:e})=>[y(R(e.base_cost)+" \u5143 ",1)]),_:1}),o(r,{align:"center",prop:"add_time_cost",label:"\u52A0\u65F6\u8D39\u7528"},{default:a(({row:e})=>[y(R(e.add_time_cost)+" \u5143 ",1)]),_:1}),o(r,{align:"center",prop:"adjust_money",label:"\u624B\u52A8\u8C03\u5DEE"},{default:a(({row:e})=>[u("div",{class:"sd",onClick:l=>n(e)},R(e.adjust_money)+" \u5143",9,no)]),_:1}),o(r,{align:"center",prop:"cost",label:"\u603B\u8D39\u7528"},{default:a(({row:e})=>[y(R(e.cost)+" \u5143 ",1)]),_:1}),o(r,{align:"center",prop:"order_info",label:"\u8BA2\u5355","min-width":"200"},{default:a(({row:e})=>[e.order_info.length>0?(b(),U("div",{key:0,class:"order-box",onClick:l=>i(e)},[ye(' {{ row.order_info.join(",") }} '),(b(!0),U(L,null,A(e.order_info,l=>(b(),U("span",uo,R(l.order_content)+" x "+R(l.count),1))),256))],8,so)):(b(),U("a",{key:1,class:"no-data-link c-p",onClick:l=>i(e)},"\u53BB\u6DFB\u52A0\u5546\u54C1",8,io))]),_:1}),o(r,{align:"center",fixed:"right",prop:"zip",label:"\u6682\u505C/\u6062\u590D",width:"120"},{default:a(({row:e})=>[e.pause_status==="running"?(b(),j(c,{key:0,type:"primary",onClick:l=>S(e)},{default:a(()=>[y("\u6682\u505C")]),_:2},1032,["onClick"])):(b(),j(c,{key:1,type:"danger",onClick:l=>S(e)},{default:a(()=>[y("\u6062\u590D")]),_:2},1032,["onClick"]))]),_:1}),o(r,{align:"center",fixed:"right",label:"\u5F00\u5355/\u7ED3\u5355",width:"120"},{default:a(({row:e})=>[e.order_status==="ending"?(b(),j(c,{key:0,type:"primary",onClick:l=>E(e)},{default:a(()=>[y("\u5F00\u5355")]),_:2},1032,["onClick"])):(b(),j(c,{key:1,type:"danger",onClick:l=>E(e)},{default:a(()=>[y("\u7ED3\u5355")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])])]),o(De,{data:p(_),onReloadList:t,ref_key:"RoomSetRef",ref:k},null,8,["data"]),o(Le,{onReloadList:t,ref_key:"GoodsSetRef",ref:w},null,512),o(Xe,{ref_key:"OrderRef",ref:V,onReloadList:t},null,512),o(Je,{ref_key:"ChangeRoomsetRef",ref:h,onReloadList:t},null,512)],64)}}},To=O(ro,[["__scopeId","data-v-4ded734c"]]);export{To as default};
