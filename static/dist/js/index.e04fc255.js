import{c as Q,d as P,e as I,f as F,g as W,h as Z,j as ee,k as oe}from"./element-plus.a660ad05.js";import"./axios.451cdb92.js";import{s as te,a as le,g as X,b as ae,c as ne,o as se,p as ie}from"./api.52d2d845.js";import"./qs.cb2714fe.js";import{_ as T}from"./index.7b689567.js";import{b as de,a as f,l as v,m as x,W as t,Q as s,p as l,U as y,F as L,a5 as O,u as w,E as G,aw as N,ax as j,P as A,I as ce,V as R,R as K,X as M,af as ue,T as re}from"./@vue.a82e9935.js";import{_ as pe}from"./lodash.02dd5408.js";import"./randomcolor.586e56a3.js";import"./lodash-es.39464d94.js";import"./@vueuse.370d0333.js";import"./@popperjs.fd04dfd6.js";import"./@ctrl.5f67d428.js";import"./dayjs.38009a6e.js";import"./async-validator.73a10b83.js";import"./memoize-one.c87f6fc8.js";import"./escape-html.86960cf8.js";import"./normalize-wheel-es.e2b4fa49.js";import"./@floating-ui.cac404ee.js";import"./side-channel.0f31c79c.js";import"./get-intrinsic.0f3ed0a2.js";import"./has-symbols.6b764405.js";import"./function-bind.c99feded.js";import"./has.38a7880d.js";import"./call-bind.00b5229b.js";import"./object-inspect.d900f9c3.js";import"./vue-router.4f0e1aa5.js";import"./pinia.b147f849.js";import"./vue-demi.6e7a88e9.js";import"./default-passive-events.a10ec130.js";function H(c){c.target.value=c.target.value.match(/^\d*(\.?\d{0,2})/g)[0]||null}const _e=c=>(N("data-v-199f46ee"),c=c(),j(),c),me={class:"room-dialog"},ve={class:"room-container"},fe=_e(()=>l("div",{class:"title"},[l("span",null,"\u623F\u95F4\u540D"),l("span",null,"\u5355\u4EF7(\u5143)"),l("span")],-1)),he={class:"content"},ge={class:"item add-item"},ye={class:"dialog-footer"},ke={__name:"RoomSet",props:{data:{type:Array}},emits:["reloadList"],setup(c,{expose:D,emit:E}){const _=c;de(()=>_.data,a=>{});const i=f([]);let p=f(""),n=f("");function V(){if(p.value){if(!n.value){I.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}}else{I.error("\u8BF7\u5148\u586B\u5165\u623F\u95F4\u540D");return}const a={id:"",name:p.value,price:n.value};i.value.push(a),p.value="",n.value=""}function U(a){let o=i.value.findIndex(m=>m.name==a.name);i.value.splice(o,1)}let h=f(!1);function B(){h.value=!0,i.value=[],_.data.forEach(a=>{i.value.push({id:a.id,name:a.name,price:a.price})})}function u(){h.value=!1}async function k(){p.value&&n&&V();const a=await te(i.value);console.log(a),a.code==200?(I.success("\u7F16\u8F91\u6210\u529F"),E("reloadList"),u()):I.error(a.msg)}return D({show:B}),(a,o)=>{const m=Q,g=F,r=P;return v(),x("div",me,[t(r,{modelValue:w(h),"onUpdate:modelValue":o[3]||(o[3]=e=>G(h)?h.value=e:h=e),title:"\u623F\u95F4\u8BBE\u7F6E",width:"600",center:""},{footer:s(()=>[l("span",ye,[t(g,{onClick:o[2]||(o[2]=e=>u())},{default:s(()=>[y("\u53D6\u6D88")]),_:1}),t(g,{type:"primary",onClick:k},{default:s(()=>[y(" \u786E\u8BA4 ")]),_:1})])]),default:s(()=>[l("div",ve,[fe,l("div",he,[(v(!0),x(L,null,O(i.value,e=>(v(),x("div",{class:"item del-items",key:e.id},[t(m,{placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D",modelValue:e.name,"onUpdate:modelValue":$=>e.name=$},null,8,["modelValue","onUpdate:modelValue"]),t(m,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",onKeyup:w(H),modelValue:e.price,"onUpdate:modelValue":$=>e.price=$},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),t(g,{type:"danger",onClick:$=>U(e)},{default:s(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),l("div",ge,[t(m,{modelValue:w(p),"onUpdate:modelValue":o[0]||(o[0]=e=>G(p)?p.value=e:p=e),placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D"},null,8,["modelValue"]),t(m,{modelValue:w(n),"onUpdate:modelValue":o[1]||(o[1]=e=>G(n)?n.value=e:n=e),onKeyup:w(H),placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue","onKeyup"]),t(g,{type:"primary",onClick:V},{default:s(()=>[y("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])])}}},Ve=T(ke,[["__scopeId","data-v-199f46ee"]]);const be=c=>(N("data-v-a968bc60"),c=c(),j(),c),Ce={class:"room-container"},xe=be(()=>l("div",{class:"title"},[l("span",null,"\u5546\u54C1\u540D\u79F0"),l("span",null,"\u5355\u4EF7(\u5143)"),l("span")],-1)),Ie={class:"content"},$e={class:"item add-item"},we={class:"dialog-footer"},Se={__name:"GoodsSet",props:{data:{type:Array}},emits:["reloadList"],setup(c,{expose:D,emit:E}){async function _(){i.value=[];const a=await X();console.log(a),a.code==200&&a.data.forEach(o=>{i.value.push(o)})}const i=f([]);let p=f(""),n=f("");function V(){if(p.value){if(!n.value){I.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}}else{I.error("\u8BF7\u5148\u586B\u5165\u5546\u54C1\u540D\u79F0");return}const a={id:"",name:p.value,price:n.value};i.value.push(a),p.value="",n.value=""}function U(a){let o=i.value.findIndex(m=>m.name==a.name);i.value.splice(o,1)}let h=f(!1);function B(){h.value=!0,_()}function u(){h.value=!1}async function k(){p.value&&n&&V();const a=await le(i.value);a.code==200?(I.success("\u7F16\u8F91\u6210\u529F"),E("reloadList"),u()):I.error(a.msg)}return D({show:B}),(a,o)=>{const m=Q,g=F,r=P;return v(),A(r,{modelValue:w(h),"onUpdate:modelValue":o[3]||(o[3]=e=>G(h)?h.value=e:h=e),title:"\u5546\u54C1\u8BBE\u7F6E",width:"600",center:""},{footer:s(()=>[l("span",we,[t(g,{onClick:o[2]||(o[2]=e=>u())},{default:s(()=>[y("\u53D6\u6D88")]),_:1}),t(g,{type:"primary",onClick:k},{default:s(()=>[y(" \u786E\u8BA4 ")]),_:1})])]),default:s(()=>[l("div",Ce,[xe,l("div",Ie,[(v(!0),x(L,null,O(i.value,e=>(v(),x("div",{class:"item del-items",key:e.name},[t(m,{placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",modelValue:e.name,"onUpdate:modelValue":$=>e.name=$},null,8,["modelValue","onUpdate:modelValue"]),t(m,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",modelValue:e.price,"onUpdate:modelValue":$=>e.price=$},null,8,["modelValue","onUpdate:modelValue"]),t(g,{type:"danger",onClick:$=>U(e)},{default:s(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),l("div",$e,[t(m,{modelValue:w(p),"onUpdate:modelValue":o[0]||(o[0]=e=>G(p)?p.value=e:p=e),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"]),t(m,{modelValue:w(n),"onUpdate:modelValue":o[1]||(o[1]=e=>G(n)?n.value=e:n=e),modelModifiers:{number:!0},placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue"]),t(g,{type:"primary",onClick:V},{default:s(()=>[y("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])}}},Re=T(Se,[["__scopeId","data-v-a968bc60"]]);const q=c=>(N("data-v-5e0ecc86"),c=c(),j(),c),De={class:"order-container"},Ee={class:"yidian"},Be=q(()=>l("div",{class:"desc"},"\u5DF2\u70B9",-1)),Ue={class:"box"},Ae={class:"goods-wrap"},Ge=q(()=>l("div",{class:"desc"},"\u5546\u54C1",-1)),Le={class:"goods-box"},Oe={class:"name"},Fe={class:"price"},Te={class:"choose-wrap"},Ne={class:"choose-item"},je={class:"handle-box"},ze=ce({__name:"Order",emits:["reloadList"],setup(c,{expose:D,emit:E}){const _=f([]),i=f([]);async function p(){i.value=[];const d=await X();d.code==200&&d.data.forEach(b=>{i.value.push(b)})}const n=f("");let V;function U(d){n.value=d.name,V=_.value.findIndex(b=>b.order_content===d.name)}function h(d){console.log(d),n.value=d.name,V=_.value.findIndex(b=>b.order_content===d.name),u()}function B(d){console.log(d),W.confirm("\u786E\u8BA4\u5220\u9664?","\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{_.value.splice(d,1),console.log(_.value),_.value=_.value}).catch(()=>{})}function u(){if(!n.value)return;let d={order_content:n.value,count:k.value};V===-1?_.value.push(d):_.value[V]=d,k.value=1,n.value=""}const k=f(1),a=d=>{console.log(d)};async function o(){console.log("click"),_.value.forEach(S=>{S!=null&&S.order_id||(S.order_id="")});let d={id:r.value,data:_.value};console.log(d);const b=await ae(d);b.code==200?(I.success("\u7F16\u8F91\u6210\u529F"),E("reloadList"),$()):I.error(b.msg)}const m=f("");let g=f(!1),r=f("");function e(d){g.value=!0,r.value=d.id,m.value=d.name+"\u70B9\u5355",p(),_.value=pe.cloneDeep(d.order_info)}function $(){g.value=!1}return D({show:e}),(d,b)=>{const S=F,J=Z,Y=P;return v(),A(Y,{modelValue:w(g),"onUpdate:modelValue":b[1]||(b[1]=C=>G(g)?g.value=C:g=C),title:m.value,width:"900",center:""},{default:s(()=>[l("div",De,[l("div",Ee,[Be,l("div",Ue,[(v(!0),x(L,null,O(_.value,(C,z)=>(v(),x("div",{class:"item",key:C.order_id},[y(R(C.order_content)+" x "+R(C.count)+" ",1),t(S,{size:"small",link:"",type:"danger",onClick:Ze=>B(z)},{default:s(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128))])]),l("div",Ae,[Ge,l("div",Le,[(v(!0),x(L,null,O(i.value,C=>(v(),A(S,{class:"item",onClick:z=>U(C),onDblclick:z=>h(C)},{default:s(()=>[l("span",Oe,R(C.name),1),l("span",Fe,R(C.price)+"\u5143",1)]),_:2},1032,["onClick","onDblclick"]))),256))])]),l("div",Te,[l("div",Ne,R(n.value),1),l("div",je,[K(t(J,{modelValue:k.value,"onUpdate:modelValue":b[0]||(b[0]=C=>k.value=C),min:1,max:999,onChange:a},null,8,["modelValue"]),[[M,n.value]]),K(t(S,{type:"primary",onClick:u},{default:s(()=>[y("\u786E\u5B9A")]),_:1},512),[[M,n.value]]),t(S,{type:"primary",onClick:o},{default:s(()=>[y("\u4FDD\u5B58")]),_:1})])])])]),_:1},8,["modelValue","title"])}}}),Pe=T(ze,[["__scopeId","data-v-5e0ecc86"]]);const Ke=c=>(N("data-v-4380c80f"),c=c(),j(),c),Me={class:"dashborad-container"},He={class:"left-nav"},Qe=Ke(()=>l("div",{class:"nav-item"}," \u5386\u53F2\u8BA2\u5355 ",-1)),We={class:"content"},Xe=["onClick"],qe={class:"g-item"},Je=["onClick"],Ye={__name:"index",setup(c){function D(u){console.log("click"),W.confirm(`\u786E\u8BA4${u.order_status=="ending"?"\u5F00\u59CB":"\u7ED3\u675F"}\u5F53\u524D\u8BA2\u5355\uFF1F`,"\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const k=await se({id:u.id,action:u.order_status==="ending"?"open":"end"});i(),console.log(k)}).catch(()=>{})}async function E(u){console.log(u.pause_status);const k=await ie({id:u.id,action:u.pause_status==="running"?"pause":"run"});k.code==200?(I.success("\u64CD\u4F5C\u6210\u529F"),i()):I.success(k.msg)}const _=f([]);async function i(){const u=await ne();console.log(u),u.code==200&&(_.value=u.data)}setInterval(()=>{i()},5e3),i();let p=f(null);function n(){console.log("123"),p.value.show()}let V=f(null);function U(){V.value.show()}let h=f(null);function B(u){h.value.show(u)}return(u,k)=>{const a=ue("router-link"),o=ee,m=F,g=oe;return v(),x(L,null,[l("div",Me,[l("div",He,[l("div",{class:"nav-item",onClick:n}," \u623F\u95F4\u8BBE\u7F6E "),l("div",{class:"nav-item",onClick:U}," \u5546\u54C1\u8BBE\u7F6E "),t(a,{to:"/history"},{default:s(()=>[Qe]),_:1})]),l("div",We,[t(g,{data:w(_),border:"",style:{width:"100%"}},{default:s(()=>[t(o,{align:"center",prop:"name",label:"\u623F\u95F4\u540D",width:"150"}),t(o,{align:"center",prop:"price",label:"\u5355\u4EF7",width:"120"},{default:s(({row:r})=>[y(R(r.price)+" \u5143 ",1)]),_:1}),t(o,{align:"center",prop:"start_time",label:"\u5F00\u59CB\u65F6\u95F4"}),t(o,{align:"center",prop:"end_time",label:"\u7ED3\u675F\u65F6\u95F4"}),t(o,{align:"center",prop:"total_time",label:"\u5F53\u524D\u65F6\u957F"}),t(o,{align:"center",prop:"pause_time",label:"\u6682\u505C\u65F6\u957F"}),t(o,{align:"center",prop:"cost",label:"\u603B\u8D39\u7528"},{default:s(({row:r})=>[y(R(r.cost)+" \u5143 ",1)]),_:1}),t(o,{align:"center",prop:"order_info",label:"\u8BA2\u5355","min-width":"200"},{default:s(({row:r})=>[r.order_info.length>0?(v(),x("div",{key:0,class:"order-box",onClick:e=>B(r)},[re(' {{ row.order_info.join(",") }} '),(v(!0),x(L,null,O(r.order_info,e=>(v(),x("span",qe,R(e.order_content)+" x "+R(e.count),1))),256))],8,Xe)):(v(),x("a",{key:1,class:"no-data-link c-p",onClick:e=>B(r)},"\u53BB\u6DFB\u52A0\u5546\u54C1",8,Je))]),_:1}),t(o,{align:"center",fixed:"right",prop:"zip",label:"\u6682\u505C/\u6062\u590D",width:"120"},{default:s(({row:r})=>[r.pause_status==="running"?(v(),A(m,{key:0,size:"small",type:"primary",onClick:e=>E(r)},{default:s(()=>[y("\u6682\u505C")]),_:2},1032,["onClick"])):(v(),A(m,{key:1,type:"danger",size:"small",onClick:e=>E(r)},{default:s(()=>[y("\u6062\u590D")]),_:2},1032,["onClick"]))]),_:1}),t(o,{align:"center",fixed:"right",label:"\u5F00\u5355/\u7ED3\u5355",width:"120"},{default:s(({row:r})=>[r.order_status==="ending"?(v(),A(m,{key:0,type:"primary",size:"small",onClick:e=>D(r)},{default:s(()=>[y("\u5F00\u5355")]),_:2},1032,["onClick"])):(v(),A(m,{key:1,type:"danger",size:"small",onClick:e=>D(r)},{default:s(()=>[y("\u7ED3\u5355")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])])]),t(Ve,{data:w(_),onReloadList:i,ref_key:"RoomSetRef",ref:p},null,8,["data"]),t(Re,{onReloadList:i,ref_key:"GoodsSetRef",ref:V},null,512),t(Pe,{ref_key:"OrderRef",ref:h,onReloadList:i},null,512)],64)}}},Do=T(Ye,[["__scopeId","data-v-4380c80f"]]);export{Do as default};
