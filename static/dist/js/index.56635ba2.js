import{c as P,d as G,e as $,f as Y,g as Q,h as ee,j as oe,k as le,l as te,m as ae,n as ne,o as se}from"./element-plus.3c007d8c.js";import"./axios.451cdb92.js";import{s as de,a as ue,g as W,b as ie,c as re,d as ce,o as me,p as pe}from"./api.904a5dd7.js";import"./qs.cb2714fe.js";import{_ as O}from"./index.37d542be.js";import{b as _e,a as f,l as g,m as U,W as o,Q as a,p as s,U as y,F as L,a5 as A,u as p,E as F,aw as T,ax as M,P as j,I as fe,V as R,R as H,X as q,$ as z,D as ve,af as he,T as ye}from"./@vue.a82e9935.js";import{_ as ge}from"./lodash.02dd5408.js";import"./randomcolor.586e56a3.js";import{h as Ve}from"./moment.3fe379a8.js";import"./lodash-es.39464d94.js";import"./@vueuse.370d0333.js";import"./@popperjs.fd04dfd6.js";import"./@ctrl.5f67d428.js";import"./dayjs.38009a6e.js";import"./async-validator.73a10b83.js";import"./memoize-one.c87f6fc8.js";import"./escape-html.86960cf8.js";import"./normalize-wheel-es.e2b4fa49.js";import"./@floating-ui.cac404ee.js";import"./side-channel.0f31c79c.js";import"./get-intrinsic.0f3ed0a2.js";import"./has-symbols.6b764405.js";import"./function-bind.c99feded.js";import"./has.38a7880d.js";import"./call-bind.00b5229b.js";import"./object-inspect.d900f9c3.js";import"./vue-router.4f0e1aa5.js";import"./pinia.b147f849.js";import"./vue-demi.6e7a88e9.js";import"./default-passive-events.a10ec130.js";function K(v){v.target.value=v.target.value.match(/^\d*(\.?\d{0,2})/g)[0]||null}const be=v=>(T("data-v-5134c234"),v=v(),M(),v),ke={class:"room-dialog"},Ce={class:"room-container"},xe=be(()=>s("div",{class:"title"},[s("span",null,"\u623F\u95F4\u540D"),s("span",null,"\u5355\u4EF7(\u5143)"),s("span",null,"\u5957\u9910\u4EF7(\u5143)"),s("span",null,"\u5957\u9910\u65F6\u5E38"),s("span")],-1)),$e={class:"content"},Ie={class:"item add-item"},Re={class:"dialog-footer"},Ue={__name:"RoomSet",props:{data:{type:Array}},emits:["reloadList"],setup(v,{expose:E,emit:w}){const h=v;_e(()=>h.data,u=>{});const d=f([]);let _=f(""),t=f(""),V=f(""),k=f("");function C(){if(_.value)if(t.value)if(V){if(!k){$.error("\u8BF7\u5148\u586B\u5165\u5957\u9910\u65F6\u957F");return}}else{$.error("\u8BF7\u5148\u586B\u5165\u5957\u9910\u4EF7");return}else{$.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}else{$.error("\u8BF7\u5148\u586B\u5165\u623F\u95F4\u540D");return}const u={id:"",name:_.value,price:t.value,base_price:V.value,base_hours:k.value};d.value.push(u),_.value="",t.value="",V.value="",k.value=""}function S(u){let m=d.value.findIndex(r=>r.name==u.name);d.value.splice(m,1)}let x=f(!1);function b(){x.value=!0,d.value=[],h.data.forEach(u=>{console.log(u),d.value.push({id:u.id,name:u.name,price:u.price,base_price:u.base_cost})})}function i(){x.value=!1}async function n(){_.value&&t&&V&&k&&C();const u=await de(d.value);console.log(u),u.code==200?($.success("\u7F16\u8F91\u6210\u529F"),w("reloadList"),i()):$.error(u.msg)}return E({show:b}),(u,m)=>{const r=P,c=Y,D=G;return g(),U("div",ke,[o(D,{modelValue:p(x),"onUpdate:modelValue":m[5]||(m[5]=e=>F(x)?x.value=e:x=e),title:"\u623F\u95F4\u8BBE\u7F6E",width:"600",center:""},{footer:a(()=>[s("span",Re,[o(c,{onClick:m[4]||(m[4]=e=>i())},{default:a(()=>[y("\u53D6\u6D88")]),_:1}),o(c,{type:"primary",onClick:n},{default:a(()=>[y(" \u786E\u8BA4 ")]),_:1})])]),default:a(()=>[s("div",Ce,[xe,s("div",$e,[(g(!0),U(L,null,A(d.value,e=>(g(),U("div",{class:"item del-items",key:e.id},[o(r,{placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D",modelValue:e.name,"onUpdate:modelValue":l=>e.name=l},null,8,["modelValue","onUpdate:modelValue"]),o(r,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",onKeyup:p(K),modelValue:e.price,"onUpdate:modelValue":l=>e.price=l},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),o(r,{placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u4EF7",onKeyup:p(K),modelValue:e.base_price,"onUpdate:modelValue":l=>e.base_price=l},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),o(r,{placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u65F6\u957F",onKeyup:p(K),modelValue:e.base_hours,"onUpdate:modelValue":l=>e.base_hours=l},null,8,["onKeyup","modelValue","onUpdate:modelValue"]),o(c,{type:"danger",onClick:l=>S(e)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),s("div",Ie,[o(r,{modelValue:p(_),"onUpdate:modelValue":m[0]||(m[0]=e=>F(_)?_.value=e:_=e),placeholder:"\u8BF7\u8F93\u5165\u623F\u95F4\u540D"},null,8,["modelValue"]),o(r,{modelValue:p(t),"onUpdate:modelValue":m[1]||(m[1]=e=>F(t)?t.value=e:t=e),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue","onKeyup"]),o(r,{modelValue:p(V),"onUpdate:modelValue":m[2]||(m[2]=e=>F(V)?V.value=e:V=e),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u4EF7"},null,8,["modelValue","onKeyup"]),o(r,{modelValue:p(k),"onUpdate:modelValue":m[3]||(m[3]=e=>F(k)?k.value=e:k=e),onKeyup:p(K),placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u65F6\u957F"},null,8,["modelValue","onKeyup"]),o(c,{type:"primary",onClick:C},{default:a(()=>[y("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])])}}},De=O(Ue,[["__scopeId","data-v-5134c234"]]);const Ee=v=>(T("data-v-a968bc60"),v=v(),M(),v),we={class:"room-container"},Se=Ee(()=>s("div",{class:"title"},[s("span",null,"\u5546\u54C1\u540D\u79F0"),s("span",null,"\u5355\u4EF7(\u5143)"),s("span")],-1)),Be={class:"content"},Fe={class:"item add-item"},je={class:"dialog-footer"},Ke={__name:"GoodsSet",props:{data:{type:Array}},emits:["reloadList"],setup(v,{expose:E,emit:w}){async function h(){d.value=[];const i=await W();console.log(i),i.code==200&&i.data.forEach(n=>{d.value.push(n)})}const d=f([]);let _=f(""),t=f("");function V(){if(_.value){if(!t.value){$.error("\u8BF7\u5148\u586B\u5165\u4EF7\u683C");return}}else{$.error("\u8BF7\u5148\u586B\u5165\u5546\u54C1\u540D\u79F0");return}const i={id:"",name:_.value,price:t.value};d.value.push(i),_.value="",t.value=""}function k(i){let n=d.value.findIndex(u=>u.name==i.name);d.value.splice(n,1)}let C=f(!1);function S(){C.value=!0,h()}function x(){C.value=!1}async function b(){_.value&&t&&V();const i=await ue(d.value);i.code==200?($.success("\u7F16\u8F91\u6210\u529F"),w("reloadList"),x()):$.error(i.msg)}return E({show:S}),(i,n)=>{const u=P,m=Y,r=G;return g(),j(r,{modelValue:p(C),"onUpdate:modelValue":n[3]||(n[3]=c=>F(C)?C.value=c:C=c),title:"\u5546\u54C1\u8BBE\u7F6E",width:"600",center:""},{footer:a(()=>[s("span",je,[o(m,{onClick:n[2]||(n[2]=c=>x())},{default:a(()=>[y("\u53D6\u6D88")]),_:1}),o(m,{type:"primary",onClick:b},{default:a(()=>[y(" \u786E\u8BA4 ")]),_:1})])]),default:a(()=>[s("div",we,[Se,s("div",Be,[(g(!0),U(L,null,A(d.value,c=>(g(),U("div",{class:"item del-items",key:c.name},[o(u,{placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",modelValue:c.name,"onUpdate:modelValue":D=>c.name=D},null,8,["modelValue","onUpdate:modelValue"]),o(u,{placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7",modelValue:c.price,"onUpdate:modelValue":D=>c.price=D},null,8,["modelValue","onUpdate:modelValue"]),o(m,{type:"danger",onClick:D=>k(c)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128)),s("div",Fe,[o(u,{modelValue:p(_),"onUpdate:modelValue":n[0]||(n[0]=c=>F(_)?_.value=c:_=c),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"]),o(u,{modelValue:p(t),"onUpdate:modelValue":n[1]||(n[1]=c=>F(t)?t.value=c:t=c),modelModifiers:{number:!0},placeholder:"\u8BF7\u8F93\u5165\u5355\u4EF7"},null,8,["modelValue"]),o(m,{type:"primary",onClick:V},{default:a(()=>[y("\u6DFB\u52A0")]),_:1})])])])]),_:1},8,["modelValue"])}}},Le=O(Ke,[["__scopeId","data-v-a968bc60"]]);const X=v=>(T("data-v-4cf72579"),v=v(),M(),v),Ae={class:"order-container"},Ye={class:"yidian"},Ge=X(()=>s("div",{class:"desc"},"\u5DF2\u70B9",-1)),Oe={class:"box"},Te={class:"goods-wrap"},Me=X(()=>s("div",{class:"desc"},"\u5546\u54C1",-1)),Ne={class:"goods-box"},Pe={class:"name"},He={class:"price"},qe={class:"choose-wrap"},ze={class:"choose-item"},Qe={class:"handle-box"},We=fe({__name:"Order",emits:["reloadList"],setup(v,{expose:E,emit:w}){const h=f([]),d=f([]);async function _(){d.value=[];const e=await W();e.code==200&&e.data.forEach(l=>{d.value.push(l)})}const t=f("");let V;function k(e){t.value=e.name,V=h.value.findIndex(l=>l.order_content===e.name)}function C(e){console.log(e),t.value=e.name,V=h.value.findIndex(l=>l.order_content===e.name),x()}function S(e){console.log(e),Q.confirm("\u786E\u8BA4\u5220\u9664?","\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{h.value.splice(e,1),console.log(h.value),h.value=h.value}).catch(()=>{})}function x(){if(!t.value)return;let e={order_content:t.value,count:b.value};V===-1?h.value.push(e):h.value[V].count+=b.value,b.value=1,t.value=""}const b=f(1),i=e=>{console.log(e)};async function n(){console.log("click"),h.value.forEach(B=>{B!=null&&B.order_id||(B.order_id="")});let e={id:r.value,data:h.value};console.log(e);const l=await ie(e);l.code==200?($.success("\u7F16\u8F91\u6210\u529F"),w("reloadList"),D()):$.error(l.msg)}const u=f("");let m=f(!1),r=f("");function c(e){m.value=!0,r.value=e.id,u.value=e.name+"\u70B9\u5355",_(),h.value=ge.cloneDeep(e.order_info)}function D(){m.value=!1}return E({show:c}),(e,l)=>{const B=Y,J=ee,Z=G;return g(),j(Z,{modelValue:p(m),"onUpdate:modelValue":l[1]||(l[1]=I=>F(m)?m.value=I:m=I),title:u.value,width:"900",center:""},{default:a(()=>[s("div",Ae,[s("div",Ye,[Ge,s("div",Oe,[(g(!0),U(L,null,A(h.value,(I,N)=>(g(),U("div",{class:"item",key:I.order_id},[y(R(I.order_content)+" x "+R(I.count)+" ",1),o(B,{size:"small",link:"",type:"danger",onClick:co=>S(N)},{default:a(()=>[y("\u5220\u9664")]),_:2},1032,["onClick"])]))),128))])]),s("div",Te,[Me,s("div",Ne,[(g(!0),U(L,null,A(d.value,I=>(g(),j(B,{class:"item",onClick:N=>k(I),onDblclick:N=>C(I)},{default:a(()=>[s("span",Pe,R(I.name),1),s("span",He,R(I.price)+"\u5143",1)]),_:2},1032,["onClick","onDblclick"]))),256))])]),s("div",qe,[s("div",ze,R(t.value),1),s("div",Qe,[H(o(J,{modelValue:b.value,"onUpdate:modelValue":l[0]||(l[0]=I=>b.value=I),min:1,max:999,onChange:i},null,8,["modelValue"]),[[q,t.value]]),H(o(B,{type:"primary",onClick:x},{default:a(()=>[y("\u786E\u5B9A")]),_:1},512),[[q,t.value]]),o(B,{type:"primary",onClick:n},{default:a(()=>[y("\u4FDD\u5B58")]),_:1})])])])]),_:1},8,["modelValue","title"])}}}),Xe=O(We,[["__scopeId","data-v-4cf72579"]]),Je={__name:"ChangeRoomset",emits:["reloadList"],setup(v,{expose:E,emit:w}){const h=f(""),d=z({id:"",ymd:Ve().format("YYYY-MM-DD"),hms:"",adjust_money:""}),_=z({hms:[{required:!0,message:"\u8BF7\u8F93\u5165\u65F6\u95F4",trigger:"blur"}],adjust_money:[{required:!0,message:"\u8BF7\u8F93\u5165\u8C03\u5DEE\u91D1\u989D",trigger:"blur"}]}),t=f(null),V=()=>{t.value.validate(async b=>{if(b){console.log("submit!",d.time);let i={id:d.id,start_time:d.ymd+" "+d.hms,adjust_money:d.adjust_money};const n=await re(i);n.code==200?($.success("\u7F16\u8F91\u6210\u529F"),w("reloadList"),k()):$.error(n.msg)}else return console.log("error submit!"),!1})},k=()=>{t.value.resetFields(),x()},C=f(!1);function S(b){h.value=b.name+"\u4FE1\u606F\u53D8\u66F4\u8BBE\u7F6E",d.id=b.id,b.start_time!=="--:--:--"&&(d.hms=b.start_time),C.value=!0}function x(){C.value=!1}return E({show:S}),(b,i)=>{const n=oe,u=le,m=te,r=P,c=Y,D=ae,e=G;return g(),j(e,{modelValue:C.value,"onUpdate:modelValue":i[5]||(i[5]=l=>C.value=l),title:h.value,width:"600",center:""},{default:a(()=>[o(D,{ref_key:"ruleFormRef",ref:t,model:p(d),"status-icon":"",rules:p(_),"label-width":"120px",class:"demo-ruleForm"},{default:a(()=>[o(u,{label:"\u65E5\u671F",prop:"ymd"},{default:a(()=>[o(n,{modelValue:p(d).ymd,"onUpdate:modelValue":i[0]||(i[0]=l=>p(d).ymd=l),type:"date",placeholder:"\u9009\u62E9\u65F6\u95F4",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),o(u,{label:"\u65F6\u95F4",prop:"hms"},{default:a(()=>[o(m,{"value-format":"HH:mm:ss",modelValue:p(d).hms,"onUpdate:modelValue":i[1]||(i[1]=l=>p(d).hms=l),placeholder:"\u5F00\u59CB\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),o(u,{label:"\u624B\u52A8\u8C03\u5DEE\u91D1\u989D",prop:"adjust_money"},{default:a(()=>[o(r,{onKeyup:p(K),modelValue:p(d).adjust_money,"onUpdate:modelValue":i[2]||(i[2]=l=>p(d).adjust_money=l)},null,8,["onKeyup","modelValue"])]),_:1}),o(u,null,{default:a(()=>[o(c,{type:"primary",onClick:i[3]||(i[3]=l=>V(t.value))},{default:a(()=>[y("\u786E\u8BA4")]),_:1}),o(c,{onClick:i[4]||(i[4]=l=>k(t.value))},{default:a(()=>[y("\u53D6\u6D88")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}};const Ze=v=>(T("data-v-4ded734c"),v=v(),M(),v),eo={class:"dashborad-container"},oo={class:"left-nav"},lo=Ze(()=>s("div",{class:"nav-item"}," \u5386\u53F2\u8BA2\u5355 ",-1)),to={class:"content"},ao=["onClick"],no=["onClick"],so=["onClick"],uo={class:"g-item"},io=["onClick"],ro={__name:"index",setup(v){function E(n){console.log("click"),Q.confirm(`\u786E\u8BA4${n.order_status=="ending"?"\u5F00\u59CB":"\u7ED3\u675F"}\u5F53\u524D\u8BA2\u5355\uFF1F`,"\u6CE8\u610F",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{const u=await me({id:n.id,action:n.order_status==="ending"?"open":"end"});t(),console.log(u)}).catch(()=>{})}async function w(n){console.log(n.pause_status);const u=await pe({id:n.id,action:n.pause_status==="running"?"pause":"run"});u.code==200?($.success("\u64CD\u4F5C\u6210\u529F"),t()):$.success(u.msg)}const h=f(null);function d(n){h.value.show(n)}const _=f([]);async function t(){const n=await ce();console.log(n),n.code==200&&(_.value=n.data)}ve(()=>{clearInterval(V)});var V=setInterval(()=>{t()},5e3);t();let k=f(null);function C(){console.log("123"),k.value.show()}let S=f(null);function x(){S.value.show()}let b=f(null);function i(n){b.value.show(n)}return(n,u)=>{const m=he("router-link"),r=ne,c=Y,D=se;return g(),U(L,null,[s("div",eo,[s("div",oo,[s("div",{class:"nav-item",onClick:C}," \u623F\u95F4\u8BBE\u7F6E "),s("div",{class:"nav-item",onClick:x}," \u5546\u54C1\u8BBE\u7F6E "),o(m,{to:"/history"},{default:a(()=>[lo]),_:1})]),s("div",to,[o(D,{data:p(_),border:"",style:{width:"100%"}},{default:a(()=>[o(r,{align:"center",prop:"name",label:"\u623F\u95F4\u540D",width:"150"}),o(r,{align:"center",prop:"price",label:"\u5355\u4EF7",width:"120"},{default:a(({row:e})=>[y(R(e.price)+" \u5143 ",1)]),_:1}),o(r,{align:"center",prop:"start_time",label:"\u5F00\u59CB\u65F6\u95F4"},{default:a(({row:e})=>[s("div",{class:"sd",onClick:l=>d(e)},R(e.start_time),9,ao)]),_:1}),o(r,{align:"center",prop:"end_time",label:"\u7ED3\u675F\u65F6\u95F4"}),o(r,{align:"center",prop:"total_time",label:"\u5F53\u524D\u65F6\u957F"}),o(r,{align:"center",prop:"pause_time",label:"\u6682\u505C\u65F6\u957F"}),o(r,{align:"center",prop:"base_cost",label:"\u5957\u9910\u8D39\u7528"},{default:a(({row:e})=>[y(R(e.base_cost)+" \u5143 ",1)]),_:1}),o(r,{align:"center",prop:"add_time_cost",label:"\u52A0\u65F6\u8D39\u7528"},{default:a(({row:e})=>[y(R(e.add_time_cost)+" \u5143 ",1)]),_:1}),o(r,{align:"center",prop:"adjust_money",label:"\u624B\u52A8\u8C03\u5DEE"},{default:a(({row:e})=>[s("div",{class:"sd",onClick:l=>d(e)},R(e.adjust_money)+" \u5143",9,no)]),_:1}),o(r,{align:"center",prop:"cost",label:"\u603B\u8D39\u7528"},{default:a(({row:e})=>[y(R(e.cost)+" \u5143 ",1)]),_:1}),o(r,{align:"center",prop:"order_info",label:"\u8BA2\u5355","min-width":"200"},{default:a(({row:e})=>[e.order_info.length>0?(g(),U("div",{key:0,class:"order-box",onClick:l=>i(e)},[ye(' {{ row.order_info.join(",") }} '),(g(!0),U(L,null,A(e.order_info,l=>(g(),U("span",uo,R(l.order_content)+" x "+R(l.count),1))),256))],8,so)):(g(),U("a",{key:1,class:"no-data-link c-p",onClick:l=>i(e)},"\u53BB\u6DFB\u52A0\u5546\u54C1",8,io))]),_:1}),o(r,{align:"center",fixed:"right",prop:"zip",label:"\u6682\u505C/\u6062\u590D",width:"120"},{default:a(({row:e})=>[e.pause_status==="running"?(g(),j(c,{key:0,type:"primary",onClick:l=>w(e)},{default:a(()=>[y("\u6682\u505C")]),_:2},1032,["onClick"])):(g(),j(c,{key:1,type:"danger",onClick:l=>w(e)},{default:a(()=>[y("\u6062\u590D")]),_:2},1032,["onClick"]))]),_:1}),o(r,{align:"center",fixed:"right",label:"\u5F00\u5355/\u7ED3\u5355",width:"120"},{default:a(({row:e})=>[e.order_status==="ending"?(g(),j(c,{key:0,type:"primary",onClick:l=>E(e)},{default:a(()=>[y("\u5F00\u5355")]),_:2},1032,["onClick"])):(g(),j(c,{key:1,type:"danger",onClick:l=>E(e)},{default:a(()=>[y("\u7ED3\u5355")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])])]),o(De,{data:p(_),onReloadList:t,ref_key:"RoomSetRef",ref:k},null,8,["data"]),o(Le,{onReloadList:t,ref_key:"GoodsSetRef",ref:S},null,512),o(Xe,{ref_key:"OrderRef",ref:b,onReloadList:t},null,512),o(Je,{ref_key:"ChangeRoomsetRef",ref:h,onReloadList:t},null,512)],64)}}},To=O(ro,[["__scopeId","data-v-4ded734c"]]);export{To as default};
